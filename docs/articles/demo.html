<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dsOMOPHelper">
<title>Demonstration • dsOMOPHelper</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Demonstration">
<meta property="og:description" content="dsOMOPHelper">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dsOMOPHelper</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/demo.html">Demonstration</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Demonstration</h1>
            
      
      
      <div class="d-none name"><code>demo.Rmd</code></div>
    </div>

    
    
<p>This demonstration showcases the use of the <code>dsOMOPHelper</code>
package, which provides a simplified approach for extracting data from
OMOP CDM databases and integrating it with the DataSHIELD workflow
through the <code>dsOMOPClient</code> package.</p>
<p><code>dsOMOPHelper</code> allows for the extraction of variables as
needed, based on the data chosen by the user, formatting the tables and
translating all present concepts to make the information more accessible
to researchers. To assist in selecting data from the database, the
package also includes methods for exploring the data that is available.
While <code>dsOMOPHelper</code> makes working with OMOP CDM databases
easier, having a basic understanding of OMOP CDM is still
recommended.</p>
<p>It is important to note that <code>dsOMOPHelper</code> aims to show
the enhanced capabilities of tools built on <code>dsOMOPClient</code> by
making its operations simpler and automating many of its processes.
However, this ease of use might limit options for edge case situations
that demand very specific operations, where using the basic methods of
<code>dsOMOPClient</code> might be more appropriate due to its
flexibility. For further technical information about the
<code>dsOMOPClient</code> package, or if you’re considering developing a
tool based on it for a particular project, please refer to <a href="https://github.com/isglobal-brge/dsOMOPClient" class="external-link">its GitHub
repository</a>.</p>
<div class="section level2">
<h2 id="establishing-a-connection">Establishing a connection<a class="anchor" aria-label="anchor" href="#establishing-a-connection"></a>
</h2>
<p>In this example, we will be using the <a href="https://physionet.org/content/mimic-iv-demo-omop/0.9/" class="external-link">MIMIC
IV</a> data available on the <a href="https://opal.isglobal.org/brge" class="external-link">Opal server of the BRGE at
ISGlobal</a>. We will establish a connection to our server using
<code>DSI</code> with the following demonstration user credentials:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datashield/DSI/" class="external-link">DSI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datashield/DSOpal/" class="external-link">DSOpal</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">dsBaseClient</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">dsOMOPHelper</span><span class="op">)</span></span>
<span></span>
<span><span class="va">builder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://datashield.github.io/DSI/reference/newDSLoginBuilder.html" class="external-link">newDSLoginBuilder</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">builder</span><span class="op">$</span><span class="fu">append</span><span class="op">(</span></span>
<span>  server <span class="op">=</span> <span class="st">"brge"</span>,</span>
<span>  url <span class="op">=</span> <span class="st">"https://opal.isglobal.org/brge"</span>,</span>
<span>  user <span class="op">=</span> <span class="st">"omop_demo"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">"P@ssw0rd"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">logindata</span> <span class="op">&lt;-</span> <span class="va">builder</span><span class="op">$</span><span class="fu">build</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">conns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://datashield.github.io/DSI/reference/datashield.login.html" class="external-link">datashield.login</a></span><span class="op">(</span>logins <span class="op">=</span> <span class="va">logindata</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-an-interface-helper-object">Creating an interface helper object<a class="anchor" aria-label="anchor" href="#creating-an-interface-helper-object"></a>
</h2>
<p>Once we have successfully established a connection with the server,
we will create an interface helper object with
<code>ds.omop.helper</code>.</p>
<p>Our server contains the database connection resource under the name
<code>mimiciv</code> within the <code>omop_demo</code> project.
Therefore, we need to specify that, from the connection we have
established, we want to take the <code>omop_demo.mimiciv</code>
resource.</p>
<p>We also need to specify the symbol we want to use to refer to this
object. In this case, we will use <code>mimiciv</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.omop.helper.html">ds.omop.helper</a></span><span class="op">(</span>connections <span class="op">=</span> <span class="va">conns</span>,</span>
<span>                    resource <span class="op">=</span> <span class="st">"omop_demo.mimiciv"</span>,</span>
<span>                    symbol <span class="op">=</span> <span class="st">"mimiciv"</span><span class="op">)</span></span></code></pre></div>
<p>When creating the helper object, the data from the
<code>Person</code> table is automatically loaded into the specified
symbol, in this case, <code>mimiciv</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/dsBaseClient/man/ds.summary.html" class="external-link">ds.summary</a></span><span class="op">(</span><span class="st">"mimiciv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $brge</span></span>
<span><span class="co">## $brge$class</span></span>
<span><span class="co">## [1] "data.frame"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$`number of rows`</span></span>
<span><span class="co">## [1] 100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$`number of columns`</span></span>
<span><span class="co">## [1] 5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$`variables held`</span></span>
<span><span class="co">## [1] "person_id"            "gender_concept_id"    "year_of_birth"       </span></span>
<span><span class="co">## [4] "race_concept_id"      "ethnicity_concept_id"</span></span></code></pre>
<p>We will use the <code>Person</code> table as the foundation since it
serves as a central link to other clinical data tables in OMOP CDM
databases. From here, we will build our study-specific table by adding
the necessary data from other tables based on the variables required for
our particular study.</p>
</div>
<div class="section level2">
<h2 id="exploring-the-data">Exploring the data<a class="anchor" aria-label="anchor" href="#exploring-the-data"></a>
</h2>
<p>Before we can construct our own study table, it’s essential that we
understand what data is available in the database. To achieve this, we
can use the data exploration methods provided by
<code>ds.omop.helper</code>, which allow us to identify the available
tables in the database, as well as the concepts and columns each table
contains.</p>
<div class="section level3">
<h3 id="tables">Tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h3>
<p>The <code>tables</code> method returns a list of the available tables
in the database:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o</span><span class="op">$</span><span class="fu">tables</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $brge</span></span>
<span><span class="co">##  [1] "attribute_definition" "care_site"            "cdm_source"          </span></span>
<span><span class="co">##  [4] "cohort"               "cohort_attribute"     "cohort_definition"   </span></span>
<span><span class="co">##  [7] "concept"              "concept_relationship" "condition_era"       </span></span>
<span><span class="co">## [10] "condition_occurrence" "cost"                 "death"               </span></span>
<span><span class="co">## [13] "device_exposure"      "dose_era"             "drug_era"            </span></span>
<span><span class="co">## [16] "drug_exposure"        "fact_relationship"    "location"            </span></span>
<span><span class="co">## [19] "measurement"          "metadata"             "note"                </span></span>
<span><span class="co">## [22] "note_nlp"             "observation"          "observation_period"  </span></span>
<span><span class="co">## [25] "payer_plan_period"    "person"               "procedure_occurrence"</span></span>
<span><span class="co">## [28] "provider"             "specimen"             "visit_detail"        </span></span>
<span><span class="co">## [31] "visit_occurrence"     "vocabulary"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="concepts">Concepts<a class="anchor" aria-label="anchor" href="#concepts"></a>
</h3>
<p>The <code>concepts</code> method returns a data frame that functions
as a dictionary for the available concepts within a specific table.
Here, <code>concept_id</code> refers to the identifier of the present
concepts, and <code>concept_name</code> is the textual name assigned to
each concept.</p>
<p>For instance, if we want to explore the concepts available in the
<code>Measurement</code> table:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o</span><span class="op">$</span><span class="fu">concepts</span><span class="op">(</span><span class="st">"measurement"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $brge</span></span>
<span><span class="co">##    concept_id                                         concept_name</span></span>
<span><span class="co">## 1           0                                  No matching concept</span></span>
<span><span class="co">## 2     1175625                              Breath rate spontaneous</span></span>
<span><span class="co">## 3     3000067   Parathyrin.intact [Mass/volume] in Serum or Plasma</span></span>
<span><span class="co">## 4     3000068                        oxyCODONE [Presence] in Urine</span></span>
<span><span class="co">## 5     3000099    Nuclear Ab [Units/volume] in Serum by Immunoassay</span></span>
<span><span class="co">## 6     3000285                       Sodium [Moles/volume] in Blood</span></span>
<span><span class="co">## 7     3000330              Specific gravity of Urine by Test strip</span></span>
<span><span class="co">## 8     3000348 Leukocyte esterase [Presence] in Urine by Test strip</span></span>
<span><span class="co">## 9     3000456   Dacrocytes [Presence] in Blood by Light microscopy</span></span>
<span><span class="co">## 10    3000461                  Pressure support setting Ventilator</span></span>
<span><span class="co">##  [ reached 'max' / getOption("max.print") -- omitted 440 rows ]</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="columns">Columns<a class="anchor" aria-label="anchor" href="#columns"></a>
</h3>
<p>The <code>columns</code> method returns a list of the available
column names in a specific table. This enables us to understand what
information we can extract from each table, allowing us to select only
the columns necessary for our study.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o</span><span class="op">$</span><span class="fu">columns</span><span class="op">(</span><span class="st">"measurement"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $brge</span></span>
<span><span class="co">## $brge$measurement</span></span>
<span><span class="co">##  [1] "measurement_id"                "person_id"                    </span></span>
<span><span class="co">##  [3] "measurement_concept_id"        "measurement_date"             </span></span>
<span><span class="co">##  [5] "measurement_datetime"          "measurement_time"             </span></span>
<span><span class="co">##  [7] "measurement_type_concept_id"   "operator_concept_id"          </span></span>
<span><span class="co">##  [9] "value_as_number"               "value_as_concept_id"          </span></span>
<span><span class="co">## [11] "unit_concept_id"               "range_low"                    </span></span>
<span><span class="co">## [13] "range_high"                    "provider_id"                  </span></span>
<span><span class="co">## [15] "visit_occurrence_id"           "visit_detail_id"              </span></span>
<span><span class="co">## [17] "measurement_source_value"      "measurement_source_concept_id"</span></span>
<span><span class="co">## [19] "unit_source_value"             "value_source_value"</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="retrieving-tables">Retrieving tables<a class="anchor" aria-label="anchor" href="#retrieving-tables"></a>
</h2>
<p>Having explored the data available in the database, we are now ready
to build our study-specific table. To do this, we’ll employ the
<code>auto</code> method provided by <code>dsOMOPHelper</code>. This
method simplifies the task by automatically extracting and appending
variables from various tables to our initial table (which currently only
includes data from the <code>Person</code> table).</p>
<p>The <code>auto</code> method uses the following arguments:</p>
<ul>
<li>
<code>tables</code>: A character vector of the names of the tables
from which we want to extract data.</li>
<li>
<code>concepts</code>: A numeric vector of the concept IDs of the
concepts we want to extract.</li>
<li>
<code>columns</code>: A character vector of the column names in the
tables from which we want to extract data.</li>
</ul>
<p>All of these are optional, but it is highly recommended to utilize
them to expedite the data extraction process and the construction of the
study table.</p>
<p>For instance, let’s assume that after a data exploration phase, we
have decided to extract data on the condition
<code>Cardiac arrhythmia</code>, which has a concept ID of
<code>44784217</code> and is found in the
<code>Condition_occurrence</code> table, and the observation
<code>Body mass index 40+ - severely obese</code>, with a concept ID of
<code>4256640</code> located in the <code>Observation</code> table. We
want all columns related to both variables, so we will not specify any
column filters.</p>
<p>Our call to the <code>auto</code> method would be as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o</span><span class="op">$</span><span class="fu">auto</span><span class="op">(</span>tables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition_occurrence"</span>, <span class="st">"observation"</span><span class="op">)</span>,</span>
<span>       concepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44784217</span>, <span class="fl">4256640</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/dsBaseClient/man/ds.summary.html" class="external-link">ds.summary</a></span><span class="op">(</span><span class="st">"mimiciv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $brge</span></span>
<span><span class="co">## $brge$class</span></span>
<span><span class="co">## [1] "data.frame"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$`number of rows`</span></span>
<span><span class="co">## [1] 100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$`number of columns`</span></span>
<span><span class="co">## [1] 18</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$`variables held`</span></span>
<span><span class="co">##  [1] "person_id"                                                    </span></span>
<span><span class="co">##  [2] "gender_concept_id"                                            </span></span>
<span><span class="co">##  [3] "year_of_birth"                                                </span></span>
<span><span class="co">##  [4] "race_concept_id"                                              </span></span>
<span><span class="co">##  [5] "ethnicity_concept_id"                                         </span></span>
<span><span class="co">##  [6] "cardiac_arrhythmia.condition_occurrence_id"                   </span></span>
<span><span class="co">##  [7] "cardiac_arrhythmia.condition_start_date"                      </span></span>
<span><span class="co">##  [8] "cardiac_arrhythmia.condition_start_datetime"                  </span></span>
<span><span class="co">##  [9] "cardiac_arrhythmia.condition_end_date"                        </span></span>
<span><span class="co">## [10] "cardiac_arrhythmia.condition_end_datetime"                    </span></span>
<span><span class="co">## [11] "cardiac_arrhythmia.condition_type_concept_id"                 </span></span>
<span><span class="co">## [12] "cardiac_arrhythmia.visit_occurrence_id"                       </span></span>
<span><span class="co">## [13] "body_mass_index_40_severely_obese.observation_id"             </span></span>
<span><span class="co">## [14] "body_mass_index_40_severely_obese.observation_date"           </span></span>
<span><span class="co">## [15] "body_mass_index_40_severely_obese.observation_datetime"       </span></span>
<span><span class="co">## [16] "body_mass_index_40_severely_obese.observation_type_concept_id"</span></span>
<span><span class="co">## [17] "body_mass_index_40_severely_obese.value_as_string"            </span></span>
<span><span class="co">## [18] "body_mass_index_40_severely_obese.visit_occurrence_id"</span></span></code></pre>
<p>As we can see, the table <code>mimiciv</code> now contains
information from the <code>Condition_occurrence</code> and
<code>Observation</code> tables, with all the columns related to our
variables of interest.</p>
</div>
<div class="section level2">
<h2 id="examples-of-usage">Examples of usage<a class="anchor" aria-label="anchor" href="#examples-of-usage"></a>
</h2>
<p>In this section, we will explore some examples of how we can use the
data extraction functions of <code>dsOMOPHelper</code> in conjunction
with DataSHIELD’s environment functions to manipulate and analyze the
data.</p>
<p><code>dsOMOP</code> sequences the longitudinal data in different
columns if it detects several occurrences of a certain type of variable
associated with the same <code>person_id</code>. We will not be doing
any aggregation of the data for this example, but instead, we will be
working with the first occurrence of each kind of variable. This is why
we will be using the suffix <code>.1</code> in the variable names.</p>
<p>Let’s say we want to add the observation
<code>Marital status [NHANES]</code> to our study table. To do this, we
first need to identify the corresponding concept, which in this case is
<code>40766231</code> and is found in the <code>Observation</code> table
of the database. In this instance, since we are only interested in its
primary value and it is a categorical variable, we aim to retrieve data
from the <code>value_as_concept_id</code> column.</p>
<p>Our call to the <code>auto</code> function would be as follows:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o</span><span class="op">$</span><span class="fu">auto</span><span class="op">(</span>tables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"observation"</span><span class="op">)</span>,</span>
<span>       concepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40766231</span><span class="op">)</span>,</span>
<span>       columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"value_as_concept_id"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/dsBaseClient/man/ds.summary.html" class="external-link">ds.summary</a></span><span class="op">(</span><span class="st">"mimiciv$marital_status_nhanes.1.value_as_concept_id"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $brge</span></span>
<span><span class="co">## $brge$class</span></span>
<span><span class="co">## [1] "factor"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$length</span></span>
<span><span class="co">## [1] 100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$categories</span></span>
<span><span class="co">## [1] "divorced"      "married"       "never_married" "widowed"      </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$`count of 'divorced'`</span></span>
<span><span class="co">## [1] 10</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$`count of 'married'`</span></span>
<span><span class="co">## [1] 37</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$`count of 'never_married'`</span></span>
<span><span class="co">## [1] 30</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$`count of 'widowed'`</span></span>
<span><span class="co">## [1] 13</span></span></code></pre>
<p>As we can see, we have successfully obtained a categorical variable
containing the marital status information of the patients, specifically
with the following categories: <code>divorced</code>,
<code>married</code>, <code>never_married</code>,
<code>widowed</code>.</p>
<p>Now, we can use the <code>ds.table</code> function from
<code>dsBaseClient</code> to obtain a frequency table of that same
variable:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/dsBaseClient/man/ds.table.html" class="external-link">ds.table</a></span><span class="op">(</span><span class="st">"mimiciv$marital_status_nhanes.1.value_as_concept_id"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Data in all studies were valid </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Study 1 :  No errors reported from this study</span></span></code></pre>
<pre><code><span><span class="co">## $output.list</span></span>
<span><span class="co">## $output.list$TABLE_rvar.by.study_row.props</span></span>
<span><span class="co">##                                                    study</span></span>
<span><span class="co">## mimiciv$marital_status_nhanes.1.value_as_concept_id brge</span></span>
<span><span class="co">##                                       divorced         1</span></span>
<span><span class="co">##                                       married          1</span></span>
<span><span class="co">##                                       never_married    1</span></span>
<span><span class="co">##                                       widowed          1</span></span>
<span><span class="co">##                                       NA               1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $output.list$TABLE_rvar.by.study_col.props</span></span>
<span><span class="co">##                                                    study</span></span>
<span><span class="co">## mimiciv$marital_status_nhanes.1.value_as_concept_id brge</span></span>
<span><span class="co">##                                       divorced      0.10</span></span>
<span><span class="co">##                                       married       0.37</span></span>
<span><span class="co">##                                       never_married 0.30</span></span>
<span><span class="co">##                                       widowed       0.13</span></span>
<span><span class="co">##                                       NA            0.10</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $output.list$TABLE_rvar.by.study_counts</span></span>
<span><span class="co">##                                                    study</span></span>
<span><span class="co">## mimiciv$marital_status_nhanes.1.value_as_concept_id brge</span></span>
<span><span class="co">##                                       divorced        10</span></span>
<span><span class="co">##                                       married         37</span></span>
<span><span class="co">##                                       never_married   30</span></span>
<span><span class="co">##                                       widowed         13</span></span>
<span><span class="co">##                                       NA              10</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $output.list$TABLES.COMBINED_all.sources_proportions</span></span>
<span><span class="co">## mimiciv$marital_status_nhanes.1.value_as_concept_id</span></span>
<span><span class="co">##      divorced       married never_married       widowed            NA </span></span>
<span><span class="co">##          0.10          0.37          0.30          0.13          0.10 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $output.list$TABLES.COMBINED_all.sources_counts</span></span>
<span><span class="co">## mimiciv$marital_status_nhanes.1.value_as_concept_id</span></span>
<span><span class="co">##      divorced       married never_married       widowed            NA </span></span>
<span><span class="co">##            10            37            30            13            10 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $validity.message</span></span>
<span><span class="co">## [1] "Data in all studies were valid"</span></span></code></pre>
<p>Next, we aim to extract a numerical variable, for instance,
<code>Body weight</code>, which is identified by the concept ID
<code>3025315</code> and is located in the <code>Measurement</code>
table. In this scenario, our goal is to retrieve data from the
<code>value_as_number</code> column.</p>
<p>Our call to the <code>auto</code> function would be as follows:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o</span><span class="op">$</span><span class="fu">auto</span><span class="op">(</span>tables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"measurement"</span><span class="op">)</span>,</span>
<span>       concepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3025315</span><span class="op">)</span>,</span>
<span>       columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"value_as_number"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/dsBaseClient/man/ds.summary.html" class="external-link">ds.summary</a></span><span class="op">(</span><span class="st">"mimiciv$body_weight.1.value_as_number"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $brge</span></span>
<span><span class="co">## $brge$class</span></span>
<span><span class="co">## [1] "numeric"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$length</span></span>
<span><span class="co">## [1] 100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $brge$`quantiles &amp; mean`</span></span>
<span><span class="co">##      5%     10%     25%     50%     75%     90%     95%    Mean </span></span>
<span><span class="co">##  52.745  59.620  68.900  79.700  97.075 121.650 148.640  86.576</span></span></code></pre>
<p>As we can see, we have successfully obtained a numerical variable
that contains the body weight of the patients.</p>
<p>To visually inspect the distribution of that same variable, we can
generate a histogram using the <code>ds.histogram</code> function from
<code>dsBaseClient</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/dsBaseClient/man/ds.histogram.html" class="external-link">ds.histogram</a></span><span class="op">(</span><span class="st">"mimiciv$body_weight.1.value_as_number"</span><span class="op">)</span></span></code></pre></div>
<p><img src="demo_files/figure-html/histogram_measurement-1.png" width="700"></p>
<pre><code><span><span class="co">## $breaks</span></span>
<span><span class="co">##  [1]  38.91912  55.14396  71.36879  87.59363 103.81847 120.04330 136.26814</span></span>
<span><span class="co">##  [8] 152.49297 168.71781 184.94265 201.16748</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $counts</span></span>
<span><span class="co">##  [1]  8 26 29 19  7  4  0  0  3  0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $density</span></span>
<span><span class="co">##  [1] 0.004930712 0.016024815 0.017873832 0.011710442 0.004314373</span></span>
<span><span class="co">##  [6] 0.002465356 0.000000000 0.000000000 0.001849017 0.000000000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $mids</span></span>
<span><span class="co">##  [1]  47.03154  63.25638  79.48121  95.70605 111.93088 128.15572 144.38056</span></span>
<span><span class="co">##  [8] 160.60539 176.83023 193.05506</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $xname</span></span>
<span><span class="co">## [1] "xvect"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $equidist</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "histogram"</span></span></code></pre>
<p>Finally, we will perform a generalized linear regression (GLM)
analysis to evaluate the relationship between blood glucose, hemoglobin
A1c, and vitamin B12. To do this, we first need to extract the variables
of interest from the corresponding tables, which are present in the
<code>Measurement</code> table.</p>
<p>For blood glucose, we use the concept ID <code>3000483</code>, which
corresponds to <code>Glucose [Mass/volume] in Blood</code>. For
hemoglobin A1c, the concept ID is <code>3004410</code>, representing
<code>Hemoglobin A1c/Hemoglobin.total in Blood</code>. Lastly, for
vitamin B12, we refer to the concept ID <code>3000593</code>, linked to
<code>Cobalamin (Vitamin B12) [Mass/volume] in Serum or Plasma</code>.
Our objective is to extract the numerical values for these variables,
hence we will focus on retrieving data specifically from the
<code>value_as_number</code> column.</p>
<p>Once the data is extracted, we can use the <code>ds.glm</code>
function from <code>dsBaseClient</code> to perform the generalized
linear regression analysis:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o</span><span class="op">$</span><span class="fu">auto</span><span class="op">(</span>tables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"measurement"</span><span class="op">)</span>,</span>
<span>       concepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3000483</span>, <span class="fl">3004410</span>, <span class="fl">3000593</span><span class="op">)</span>,</span>
<span>       columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"value_as_number"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/dsBaseClient/man/ds.glm.html" class="external-link">ds.glm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="st">"glucose_mass_volume_in_blood.1.value_as_number ~ </span></span>
<span><span class="st">                  hemoglobin_a1c_hemoglobin_total_in_blood.1.value_as_number + </span></span>
<span><span class="st">                  cobalamin_vitamin_b12_mass_volume_in_serum_or_plasma.1.value_as_number"</span>,</span>
<span>       data <span class="op">=</span> <span class="st">"mimiciv"</span>,</span>
<span>       family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>       datasources <span class="op">=</span> <span class="va">conns</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Iteration 1...</span></span></code></pre>
<pre><code><span><span class="co">## CURRENT DEVIANCE:      152458</span></span></code></pre>
<pre><code><span><span class="co">## Iteration 2...</span></span></code></pre>
<pre><code><span><span class="co">## CURRENT DEVIANCE:      21068.1496506415</span></span></code></pre>
<pre><code><span><span class="co">## Iteration 3...</span></span></code></pre>
<pre><code><span><span class="co">## CURRENT DEVIANCE:      21068.1496506415</span></span></code></pre>
<pre><code><span><span class="co">## SUMMARY OF MODEL STATE after iteration 3</span></span></code></pre>
<pre><code><span><span class="co">## Current deviance 21068.1496506415 on 7 degrees of freedom</span></span></code></pre>
<pre><code><span><span class="co">## Convergence criterion TRUE (1.7267589227475e-16)</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## beta: 120.958893279016 0.82795236254575 -0.0161066743745843</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Information matrix overall:</span></span></code></pre>
<pre><code><span><span class="co">##                                                                        (Intercept)</span></span>
<span><span class="co">## (Intercept)                                                                   10.0</span></span>
<span><span class="co">## hemoglobin_a1c_hemoglobin_total_in_blood.1.value_as_number                    65.4</span></span>
<span><span class="co">## cobalamin_vitamin_b12_mass_volume_in_serum_or_plasma.1.value_as_number      7434.0</span></span>
<span><span class="co">##                                                                        hemoglobin_a1c_hemoglobin_total_in_blood.1.value_as_number</span></span>
<span><span class="co">## (Intercept)                                                                                                                 65.40</span></span>
<span><span class="co">## hemoglobin_a1c_hemoglobin_total_in_blood.1.value_as_number                                                                 451.24</span></span>
<span><span class="co">## cobalamin_vitamin_b12_mass_volume_in_serum_or_plasma.1.value_as_number                                                   47292.00</span></span>
<span><span class="co">##                                                                        cobalamin_vitamin_b12_mass_volume_in_serum_or_plasma.1.value_as_number</span></span>
<span><span class="co">## (Intercept)                                                                                                                              7434</span></span>
<span><span class="co">## hemoglobin_a1c_hemoglobin_total_in_blood.1.value_as_number                                                                              47292</span></span>
<span><span class="co">## cobalamin_vitamin_b12_mass_volume_in_serum_or_plasma.1.value_as_number                                                                7317894</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Score vector overall:</span></span></code></pre>
<pre><code><span><span class="co">##                                                                                 [,1]</span></span>
<span><span class="co">## (Intercept)                                                            -2.799538e-12</span></span>
<span><span class="co">## hemoglobin_a1c_hemoglobin_total_in_blood.1.value_as_number             -1.841727e-11</span></span>
<span><span class="co">## cobalamin_vitamin_b12_mass_volume_in_serum_or_plasma.1.value_as_number -2.106390e-09</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Current deviance: 21068.1496506415</span></span></code></pre>
<pre><code><span><span class="co">## $Nvalid</span></span>
<span><span class="co">## [1] 10</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Nmissing</span></span>
<span><span class="co">## [1] 90</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Ntotal</span></span>
<span><span class="co">## [1] 100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $disclosure.risk</span></span>
<span><span class="co">##      RISK OF DISCLOSURE</span></span>
<span><span class="co">## brge                  0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $errorMessage</span></span>
<span><span class="co">##      ERROR MESSAGES</span></span>
<span><span class="co">## brge "No errors"   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nsubs</span></span>
<span><span class="co">## [1] 10</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $iter</span></span>
<span><span class="co">## [1] 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $family</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## Link function: identity </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $formula</span></span>
<span><span class="co">## [1] "glucose_mass_volume_in_blood.1.value_as_number ~ hemoglobin_a1c_hemoglobin_total_in_blood.1.value_as_number +      cobalamin_vitamin_b12_mass_volume_in_serum_or_plasma.1.value_as_number"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $coefficients</span></span>
<span><span class="co">##                                                                            Estimate</span></span>
<span><span class="co">## (Intercept)                                                            120.95889328</span></span>
<span><span class="co">## hemoglobin_a1c_hemoglobin_total_in_blood.1.value_as_number               0.82795236</span></span>
<span><span class="co">## cobalamin_vitamin_b12_mass_volume_in_serum_or_plasma.1.value_as_number  -0.01610667</span></span>
<span><span class="co">##                                                                         Std. Error</span></span>
<span><span class="co">## (Intercept)                                                            89.11697092</span></span>
<span><span class="co">## hemoglobin_a1c_hemoglobin_total_in_blood.1.value_as_number             11.55494959</span></span>
<span><span class="co">## cobalamin_vitamin_b12_mass_volume_in_serum_or_plasma.1.value_as_number  0.04187167</span></span>
<span><span class="co">##                                                                            z-value</span></span>
<span><span class="co">## (Intercept)                                                             1.35730481</span></span>
<span><span class="co">## hemoglobin_a1c_hemoglobin_total_in_blood.1.value_as_number              0.07165348</span></span>
<span><span class="co">## cobalamin_vitamin_b12_mass_volume_in_serum_or_plasma.1.value_as_number -0.38466759</span></span>
<span><span class="co">##                                                                          p-value</span></span>
<span><span class="co">## (Intercept)                                                            0.1746844</span></span>
<span><span class="co">## hemoglobin_a1c_hemoglobin_total_in_blood.1.value_as_number             0.9428777</span></span>
<span><span class="co">## cobalamin_vitamin_b12_mass_volume_in_serum_or_plasma.1.value_as_number 0.7004837</span></span>
<span><span class="co">##                                                                           low0.95CI</span></span>
<span><span class="co">## (Intercept)                                                            -53.70716014</span></span>
<span><span class="co">## hemoglobin_a1c_hemoglobin_total_in_blood.1.value_as_number             -21.81933267</span></span>
<span><span class="co">## cobalamin_vitamin_b12_mass_volume_in_serum_or_plasma.1.value_as_number  -0.09817364</span></span>
<span><span class="co">##                                                                          high0.95CI</span></span>
<span><span class="co">## (Intercept)                                                            295.62494670</span></span>
<span><span class="co">## hemoglobin_a1c_hemoglobin_total_in_blood.1.value_as_number              23.47523740</span></span>
<span><span class="co">## cobalamin_vitamin_b12_mass_volume_in_serum_or_plasma.1.value_as_number   0.06596029</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $dev</span></span>
<span><span class="co">## [1] 21068.15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $df</span></span>
<span><span class="co">## [1] 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $output.information</span></span>
<span><span class="co">## [1] "SEE TOP OF OUTPUT FOR INFORMATION ON MISSING DATA AND ERROR MESSAGES"</span></span></code></pre>
<p>As we can see, the data extracted from <code>dsOMOPHelper</code> can
be perfectly integrated with DataSHIELD’s environment functions to
perform a wide range of operations, from simple descriptive statistics
to more complex statistical modeling.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/davidsarratgonzalez" class="external-link">David Sarrat González</a>, <a href="https://github.com/ESCRI11" class="external-link">Xavier Escribà-Montagut</a>, <a href="https://github.com/isglobal-brge" class="external-link">Juan R González</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

  </div></footer>
</body>
</html>
